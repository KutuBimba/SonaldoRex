local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")
local RunService = game:GetService("RunService")

-- settings (here you can set up sonaldo rex)
local Config = {
    Enabled = true,
    ChangeAllParts = true,
    SpamSound = true,
    SpamChat = true,
    SoundId = "rbxassetid://7681560017",
    ImageId = "rbxassetid://10487246132",
    ChatMessage = "SONALDO REX",
    SoundVolume = 5,
    UpdateInterval = 0.5,
    MaxPartsPerFrame = 50
}

-- gui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SonaldoControl"
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.ResetOnSpawn = false

if syn and syn.protect_gui then
    syn.protect_gui(screenGui)
end

-- main frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 180)
mainFrame.Position = UDim2.new(0.5, -125, 0, 20)
mainFrame.AnchorPoint = Vector2.new(0.5, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- onaldo sex (rex) title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(200, 30, 30)
title.Text = "⚽ SONALDO REX ⚽"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.Parent = mainFrame

-- status
local status = Instance.new("TextLabel")
status.Size = UDim2.new(1, 0, 0, 30)
status.Position = UDim2.new(0, 0, 0, 40)
status.BackgroundTransparency = 1
status.Text = "STATUS: ACTIVE"
status.TextColor3 = Color3.fromRGB(0, 255, 0)
status.Font = Enum.Font.Gotham
status.TextSize = 16
status.Parent = mainFrame

-- utton on
local onBtn = Instance.new("TextButton")
onBtn.Size = UDim2.new(0.45, 0, 0, 40)
onBtn.Position = UDim2.new(0.025, 0, 0, 80)
onBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
onBtn.Text = "ON"
onBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
onBtn.Font = Enum.Font.GothamBold
onBtn.TextSize = 18
onBtn.Parent = mainFrame

-- utton off
local offBtn = Instance.new("TextButton")
offBtn.Size = UDim2.new(0.45, 0, 0, 40)
offBtn.Position = UDim2.new(0.525, 0, 0, 80)
offBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
offBtn.Text = "OFF"
offBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
offBtn.Font = Enum.Font.GothamBold
offBtn.TextSize = 18
offBtn.Parent = mainFrame

-- test
local testBtn = Instance.new("TextButton")
testBtn.Size = UDim2.new(0.9, 0, 0, 35)
testBtn.Position = UDim2.new(0.05, 0, 0, 130)
testBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 0)
testBtn.Text = "TEST CHAOS"
testBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
testBtn.Font = Enum.Font.GothamBold
testBtn.TextSize = 16
testBtn.Parent = mainFrame

-- corner
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 10)
uiCorner.Parent = mainFrame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = onBtn
btnCorner:Clone().Parent = offBtn
btnCorner:Clone().Parent = testBtn

screenGui.Parent = game:GetService("CoreGui")

-- SONALDO REX SIXTY SVEN NIKE PRO SHELLY?

-- part changer
local function changePart(part)
    pcall(function()
        -- SONALDO REX DECAL?
        local decal = Instance.new("Decal")
        decal.Name = "SonaldoRex"
        decal.Texture = Config.ImageId
        decal.Face = Enum.NormalId.Front
        decal.Parent = part
        
        -- billboards ( bill gay ts)
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "SonaldoBillboard"
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 5, 0)
        billboard.AlwaysOnTop = true
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = "⚽ SONALDO REX ⚽"
        label.TextColor3 = Color3.fromRGB(255, 50, 50)
        label.Font = Enum.Font.GothamBold
        label.TextSize = 20
        label.TextStrokeTransparency = 0.5
        label.Parent = billboard
        
        billboard.Parent = part
        
        -- point light
        local light = Instance.new("PointLight")
        light.Name = "SonaldoLight"
        light.Color = Color3.fromRGB(255, 50, 50)
        light.Brightness = 2
        light.Range = 15
        light.Parent = part
        
        -- Я УЖЕ КРАСНЫЙ
        part.BrickColor = BrickColor.new("Really red")
        part.Material = EnumMaterial.Neon
        
        -- plasma
        local particle = Instance.new("ParticleEmitter")
        particle.Texture = "rbxassetid://10487246132"
        particle.Rate = 20
        particle.Lifetime = NumberRange.new(1, 3)
        particle.Speed = NumberRange.new(2, 5)
        particle.Size = NumberSequence.new(0.5, 1.5)
        particle.Parent = part
    end)
end

-- ll parts chanfer
local function changeAllParts()
    local partsChanged = 0
    local maxParts = 1000 -- Ограничиваем чтобы не лагать
    
    for _, part in pairs(Workspace:GetDescendants()) do
        if part:IsA("BasePart") and not part:IsA("Terrain") then
            changePart(part)
            partsChanged += 1
            
            if partsChanged % Config.MaxPartsPerFrame == 0 then
                RunService.Heartbeat:Wait()
            end
            
            if partsChanged >= maxParts then
                break
            end
        end
    end
    
    print("✅ Parts Changed:", partsChanged)
    return partsChanged
end

-- sound spam
local function spamSound()
    while Config.SpamSound and Config.Enabled do
        wait(math.random(2, 5))
        
        pcall(function()
            -- add sounds to wrksps
            local sound = Instance.new("Sound")
            sound.SoundId = Config.SoundId
            sound.Volume = Config.SoundVolume
            sound.Parent = Workspace
            
            local playerSound = Instance.new("Sound")
            playerSound.SoundId = Config.SoundId
            playerSound.Volume = Config.SoundVolume
            playerSound.Parent = game:GetService("Players").LocalPlayer:FindFirstChildOfClass("PlayerGui") or Workspace
            
            sound:Play()
            playerSound:Play()
            
            game:GetService("Debris"):AddItem(sound, 10)
            game:GetService("Debris"):AddItem(playerSound, 10)
        end)
    end
end

-- CHAT SPAAM
local function spamChat()
    while Config.SpamChat and Config.Enabled do
        wait(math.random(1, 3))
        
        pcall(function()
            -- methods
            local methods = {
                function()
                    if ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents") then
                        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(Config.ChatMessage, "All")
                    end
                end,
                function()
                    if TextChatService:FindFirstChild("TextChannels") then
                        TextChatService.TextChannels.RBXGeneral:SendAsync(Config.ChatMessage)
                    end
                end
            }
            
            for _, method in ipairs(methods) do
                pcall(method)
            end
        end)
    end
end

-- art changeer (2)
local function monitorNewParts()
    Workspace.DescendantAdded:Connect(function(descendant)
        if not Config.Enabled then return end
        
        wait(0.1) 
        
        if descendant:IsA("BasePart") and not descendant:IsA("Terrain") then
            changePart(descendant)
        end
    end)
end

-- hog 2.6 cycle
local chaosLoop
local soundLoop
local chatLoop

local function startChaos()
    if chaosLoop then chaosLoop:Disconnect() end
    
    Config.Enabled = true
    status.Text = "STATUS: ACTIVE"
    status.TextColor3 = Color3.fromRGB(0, 255, 0)
    onBtn.BackgroundColor3 = Color3.fromRGB(0, 230, 0)
    offBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    
    print("⚽ SONALDO REX CHAOS АCTIVADED!")
    
    -- HANGE
    spawn(function()
        local changed = changeAllParts()
        
        -- SUUUIII
        pcall(function()
            ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
                "⚽ SONALDO REX CHANGED " .. changed .. " PARTS! ⚽",
                "All"
            )
        end)
    end)
    
    -- aund spa,
    if soundLoop then soundLoop:Disconnect() end
    soundLoop = spawn(spamSound)
    
    -- hjat spam
    if chatLoop then chatLoop:Disconnect() end
    chatLoop = spawn(spamChat)
    
    -- monitoring
    monitorNewParts()
    
    -- hog cycle
    chaosLoop = RunService.Heartbeat:Connect(function()
        if not Config.Enabled then return end
        
        -- hange
        if math.random(1, 600) == 1 then 
            local allParts = {}
            for _, part in pairs(Workspace:GetDescendants()) do
                if part:IsA("BasePart") and not part:IsA("Terrain") then
                    table.insert(allParts, part)
                end
            end
            
            -- dhange
            for i = 1, math.min(10, #allParts) do
                local part = allParts[math.random(1, #allParts)]
                changePart(part)
            end
        end
    end)
end

local function stopChaos()
    Config.Enabled = false
    status.Text = "STATUS: INACTIVE"
    status.TextColor3 = Color3.fromRGB(255, 50, 50)
    onBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    offBtn.BackgroundColor3 = Color3.fromRGB(230, 0, 0)
    
    if chaosLoop then
        chaosLoop:Disconnect()
        chaosLoop = nil
    end
    
    print("⚽ SONALDO REX CHAOS STOPED!")
end

-- пуравляшки
onBtn.MouseButton1Click:Connect(function()
    startChaos()
    
    -- тест
    pcall(function()
        local testSound = Instance.new("Sound")
        testSound.SoundId = Config.SoundId
        testSound.Volume = 3
        testSound.Parent = Workspace
        testSound:Play()
        game:GetService("Debris"):AddItem(testSound, 5)
    end)
end)

offBtn.MouseButton1Click:Connect(function()
    stopChaos()
end)

testBtn.MouseButton1Click:Connect(function()
    -- зменфем 50 партов чтобы проверить
    local allParts = {}
    for _, part in pairs(Workspace:GetDescendants()) do
        if part:IsA("BasePart") and not part:IsA("Terrain") then
            table.insert(allParts, part)
        end
    end
    
    for i = 1, math.min(50, #allParts) do
        local part = allParts[math.random(1, #allParts)]
        changePart(part)
    end
    
    -- тест звук
    pcall(function()
        local testSound = Instance.new("Sound")
        testSound.SoundId = Config.SoundId
        testSound.Volume = 4
        testSound.Parent = Workspace
        testSound:Play()
        
        -- тест сообщ
        ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
            "⚽ SONALDO REX ТЕСТОВЫЙ РЕЖИМ! ⚽",
            "All"
        )
        
        game:GetService("Debris"):AddItem(testSound, 5)
    end)
end)

-- горячие мучачи клавиши
local UserInputService = game:GetService("UserInputService")
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F then
        if Config.Enabled then
            stopChaos()
        else
            startChaos()
        end
    end
end)

-- автостарт
wait(1)
startChaos()
